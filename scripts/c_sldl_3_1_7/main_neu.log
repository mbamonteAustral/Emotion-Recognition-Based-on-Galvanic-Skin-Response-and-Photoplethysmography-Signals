2024-03-07 18:35:34.562345: I tensorflow/core/util/port.cc:113] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2024-03-07 18:35:35.298373: I tensorflow/core/util/port.cc:113] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2024-03-07 18:35:36.769260: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
    
    
-------------------------------
participant:  1
-------------------------------
    
    
participant:  1
corriendo en PC gamer:
Window size (sec):  3.0
step (sec):  3.0
overlap:  True
perc. of overlap:  0.0
Nearest multiple of 16 to 3000 is: 3008
Nearest multiple of 16 to 3000 is: 3008
['gsr_chunks', 'ppg_chunks', 'val_chunks', 'aro_chunks', 'time_chunks', 'tag_chunks', 'video']
C:\Users\Javier\Dropbox\c_sldl_3_1_7\functions.py:880: FutureWarning: ChainedAssignmentError: behaviour will change in pandas 3.0!
You are setting values through chained assignment. Currently this works in certain cases, but when using Copy-on-Write (which will become the default behaviour in pandas 3.0) this will never work to update the original DataFrame or Series, because the intermediate object on which we are setting values will behave as a copy.

----- Extracting features...
C:\Users\Javier\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\heartpy\analysis.py:522: UserWarning: Short signal.

---------Warning:---------
too few peak-peak intervals for (reliable) frequency domain measure computation, frequency output measures are still computed but treat them with caution!

HF is usually computed over a minimum of 1 minute of good signal. LF is usually computed over a minimum of 2 minutes of good signal.VLF is usually computed over a minimum of 5 minutes of good signal.The LF/HF ratio is usually computed over minimum 24 hours, although an absolute minimum of 5 min has also been suggested.

For more info see: 
Shaffer, F., Ginsberg, J.P. (2017), An Overview of Heart Rate Variability Metrics and Norms.

Task Force of Pacing and Electrophysiology (1996), Heart Rate Variability, in: European Heart Journal, vol.17, issue 3, pp354-381

This warning will not repeat
  warnings.warn(msg, UserWarning)
C:\Users\Javier\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\heartpy\analysis.py:677: UserWarning: 
The maximal number of iterations maxit (set to 20 by the program)
allowed for finding a smoothing spline with fp=s has been reached: s
too small.
There is an approximation returned but the corresponding weighted sum
of squared residuals does not satisfy the condition abs(fp-s)/s < tol.
  interp = UnivariateSpline(x, rrlist, k=3)
Class Imbalance test (arousal)....
Multiclass distribution
Class=1, n=268 (64.115%)
Class=0, n=150 (35.885%)
Class Imbalance test (valence)....
Multiclass distribution
Class=0, n=164 (39.234%)
Class=1, n=254 (60.766%)
------------- Evaluating model --------------
------------- Evaluating model --------------
------------- Evaluating model --------------
------------- Evaluating model --------------
------------- Evaluating model --------------
arousal and valece = ok
------------- Evaluating model --------------
-------------------------------------
-------------------------------------
participant:  30
-------------------------------------
----- RESULTS ------
-------------------------------------
Window size (sec):  3.008
step (sec):  3.008
overlap:  True
perc. of overlap:  0.0
Number of windows / instances:  418
-rows: alg : KNN = 0; DT = 1; RF = 2; SVM = 3; GBM = 4; BDDAE = 5; DUMMY = 5
columns:
'val_cohen','val_uar', 'val_acc', 'val_gm',  'val_f1',  'aro_cohen','aro_uar', 'aro_acc', 'aro_gm',  'aro_f1'
-------------------------------------------------------------
  v_c   v_u   v_a   v_g   v_f1  a_c   a_u   a_a   a_g   a_f1
[[0.281 0.639 0.66  0.626 0.638 0.281 0.638 0.675 0.62  0.639]
 [0.296 0.647 0.661 0.652 0.646 0.299 0.636 0.663 0.615 0.633]
 [0.306 0.686 0.701 0.664 0.685 0.294 0.633 0.672 0.623 0.634]
 [0.    0.5   0.608 0.    0.378 0.    0.5   0.641 0.    0.391]
 [0.194 0.588 0.67  0.425 0.549 0.029 0.511 0.648 0.088 0.416]
 [0.    0.    0.    0.    0.    0.    0.    0.    0.    0.   ]
 [0.    0.5   0.608 0.    0.378 0.    0.5   0.641 0.    0.391]]
participant performance loaded
    
    
-------------------------------
LAST participant's saved data: 
30
-------------------------------
    
    
---------------------------
KNN performance:
[[0.47043868 0.72121693 0.78002323 0.69199672 0.7307745  0.32851465
  0.66543137 0.67026713 0.65945962 0.66135902]
 [0.21601336 0.59905267 0.6937863  0.53511009 0.60045796 0.2802665
  0.63198497 0.71068525 0.59414588 0.63708492]
 [       nan        nan        nan        nan        nan        nan
         nan        nan        nan        nan]
 [       nan        nan        nan        nan        nan        nan
         nan        nan        nan        nan]
 [0.09104016 0.54365079 0.62415796 0.46717816 0.53514546 0.11209769
  0.55470192 0.59529617 0.51722483 0.55090367]
 [       nan        nan        nan        nan        nan        nan
         nan        nan        nan        nan]
 [0.03841538 0.51555556 0.81806039 0.16487534 0.49896543 0.21227865
  0.60630147 0.621777   0.59479883 0.60373213]
 [       nan        nan        nan        nan        nan        nan
         nan        nan        nan        nan]
 [       nan        nan        nan        nan        nan        nan
         nan        nan        nan        nan]
 [0.10398379 0.55201299 0.55301974 0.5484631  0.55059284 0.16031263
  0.57908654 0.62909408 0.54004666 0.57507312]
 [0.05376967 0.5275768  0.54796748 0.50127925 0.5218481  0.08685749
  0.53881965 0.68182346 0.43577499 0.53640087]
 [       nan        nan        nan        nan        nan        nan
         nan        nan        nan        nan]
 [0.41907031 0.69705854 0.76062718 0.66962964 0.70631112 0.42564924
  0.7127381  0.71300813 0.70106464 0.70819878]
 [0.09486178 0.54585267 0.6004065  0.50122565 0.54220706 0.33123237
  0.65777489 0.69384437 0.63148833 0.66063119]
 [0.28132047 0.63924152 0.66039489 0.62617245 0.6382071  0.28075505
  0.63780627 0.67479675 0.62001381 0.63853429]]
KNN mean:
[0.19654596 0.59346872 0.67093819 0.52288116 0.59161218 0.24644048
 0.62051613 0.66562137 0.58822418 0.619102  ]
---------------------------
---------------------------
DT performance:
[[0.50603318 0.74939153 0.78228804 0.73393152 0.75089825 0.34763843
  0.66913562 0.67955865 0.6749397  0.66655951]
 [0.18436687 0.60031262 0.65081301 0.59185715 0.5964327  0.17959817
  0.57217065 0.63646922 0.50814714 0.57154698]
 [0.25744495 0.64512987 0.64547038 0.62282942 0.64468659 0.21193959
  0.61077959 0.61271777 0.58943695 0.60886075]
 [0.06406683 0.55067157 0.56445993 0.53237056 0.54721679 0.34887788
  0.64721324 0.66289199 0.64458851 0.6452999 ]
 [0.01648192 0.55092593 0.59587689 0.49727876 0.54712933 0.13457772
  0.58225962 0.60307782 0.52328787 0.58104347]
 [0.50713335 0.76284641 0.7728223  0.75697827 0.76367872 0.43916241
  0.71545588 0.72491289 0.70617559 0.71211796]
 [0.16519944 0.59011905 0.78739837 0.48545753 0.58573669 0.25255422
  0.61850245 0.6387921  0.6341374  0.61617043]
 [0.09108205 0.56873016 0.61480836 0.542257   0.56502051 0.19388284
  0.61405805 0.63606272 0.58342038 0.61133661]
 [0.02200439 0.5169697  0.65813008 0.41977525 0.51140011 0.02282961
  0.53564935 0.53571429 0.50635935 0.53185704]
 [0.09836671 0.55778139 0.55998839 0.54522738 0.55400407 0.22078309
  0.58156873 0.60981417 0.58093928 0.57523912]
 [0.04947455 0.51238235 0.52642276 0.46987817 0.50727297 0.12955456
  0.57696481 0.67950058 0.49334436 0.57470783]
 [0.22309123 0.61096058 0.61492451 0.6075733  0.60998883 0.19070199
  0.60418574 0.61010453 0.59464519 0.60119873]
 [0.29795133 0.65194676 0.70092915 0.63029632 0.65092833 0.23980681
  0.61761905 0.61730546 0.63035798 0.61316705]
 [0.1228881  0.55324786 0.57886179 0.55259634 0.54860424 0.27577487
  0.66012217 0.66986063 0.63588527 0.65602666]
 [0.29572103 0.64744627 0.66062718 0.65206546 0.6460464  0.29899537
  0.63574074 0.66271777 0.6154327  0.63277441]]
DT mean:
[0.1934204  0.6045908  0.64758808 0.57602483 0.6019363  0.23244517
 0.61609505 0.63863337 0.59473984 0.61319376]
---------------------------
---------------------------
RF performance:
[[0.49704232 0.71888889 0.77288037 0.7062232  0.72586838 0.34617842
  0.66883987 0.68205575 0.65394165 0.66888227]
 [0.21130207 0.57398162 0.65528455 0.54745391 0.57196425 0.11478526
  0.58240495 0.66027875 0.52339844 0.58595169]
 [0.21439922 0.62719697 0.62659698 0.64560707 0.62496333 0.19909515
  0.56950905 0.57171893 0.60163045 0.56800099]
 [0.11680162 0.54576225 0.57665505 0.49582678 0.54112332 0.37439522
  0.67068043 0.69407666 0.67484227 0.67103597]
 [0.10604914 0.52056878 0.59320557 0.53383308 0.51514823 0.03041886
  0.56270192 0.59343786 0.51589    0.56202931]
 [0.55573236 0.80022549 0.80383275 0.78531837 0.79862033 0.36778532
  0.65513971 0.67740999 0.6666347  0.65417514]
 [0.21184557 0.5609127  0.81358885 0.39979787 0.56214275 0.32276383
  0.63787745 0.6601626  0.65543144 0.63590437]
 [0.15071083 0.56277778 0.62195122 0.50012007 0.55596992 0.19219726
  0.59747685 0.63873403 0.59581989 0.59735011]
 [0.02033513 0.49716856 0.69372822 0.27148649 0.49063353 0.08082326
  0.50097403 0.50209059 0.50738008 0.49859462]
 [0.14215956 0.51201299 0.51242741 0.53435552 0.50999853 0.18745163
  0.61029915 0.66051103 0.52449718 0.6097627 ]
 [0.00858423 0.52070752 0.54541231 0.50938209 0.51651286 0.17816056
  0.54202102 0.68217189 0.49933597 0.54050189]
 [0.20440306 0.59707926 0.59779326 0.60915821 0.59372837 0.2548186
  0.6397629  0.64570267 0.588393   0.63814581]
 [0.39801679 0.69696855 0.74425087 0.66110242 0.69892253 0.37799627
  0.70119048 0.70092915 0.66703816 0.69783709]
 [0.09261756 0.5607733  0.61736353 0.52126562 0.56064265 0.2358195
  0.62990837 0.6533101  0.66730146 0.62968334]
 [0.30564978 0.68623699 0.70121951 0.66369597 0.68450208 0.29352478
  0.63299145 0.67224158 0.62303448 0.63379994]]
RF mean:
[0.21570995 0.59875078 0.6584127  0.55897511 0.59671607 0.23708093
 0.61345184 0.64632211 0.59763795 0.61277702]
---------------------------
---------------------------
SVM performance:
[[0.47528315 0.70904762 0.79674797 0.64829989 0.72432078 0.3204346
  0.65543791 0.68228804 0.63539163 0.65668347]
 [0.         0.5        0.68420441 0.         0.40622984 0.
  0.5        0.69384437 0.         0.40961771]
 [       nan        nan        nan        nan        nan        nan
         nan        nan        nan        nan]
 [       nan        nan        nan        nan        nan        nan
         nan        nan        nan        nan]
 [0.         0.5        0.66504065 0.         0.39941176 0.
  0.5        0.61718931 0.         0.38163993]
 [       nan        nan        nan        nan        nan        nan
         nan        nan        nan        nan]
 [0.         0.5        0.84216028 0.         0.45714023 0.
  0.5        0.59570267 0.         0.37330933]
 [       nan        nan        nan        nan        nan        nan
         nan        nan        nan        nan]
 [       nan        nan        nan        nan        nan        nan
         nan        nan        nan        nan]
 [0.09087206 0.54603896 0.54065041 0.5108466  0.52564164 0.
  0.5        0.63873403 0.         0.38976028]
 [0.         0.5        0.58135889 0.         0.36760463 0.
  0.5        0.7344367  0.         0.42343398]
 [       nan        nan        nan        nan        nan        nan
         nan        nan        nan        nan]
 [0.16881267 0.57043861 0.69628339 0.44124242 0.55788216 0.40179696
  0.70095238 0.70081301 0.6879572  0.6953208 ]
 [0.         0.5        0.64355401 0.         0.39155533 0.
  0.5        0.6029036  0.         0.37610876]
 [0.         0.5        0.60766551 0.         0.37795248 0.
  0.5        0.64111498 0.         0.39065542]]
SVM mean:
[0.0816631  0.53616947 0.67307395 0.17782099 0.46752654 0.08024795
 0.53959892 0.6563363  0.14703876 0.45516996]
---------------------------
---------------------------
GBM performance:
[[ 0.52420996  0.7322619   0.81341463  0.67771893  0.75195277  0.386456
   0.67947059  0.7253194   0.6225389   0.67627956]
 [ 0.04180589  0.51605722  0.68890825  0.13253979  0.44567456  0.0468863
   0.51750663  0.7033101   0.13867505  0.44740064]
 [        nan         nan         nan         nan         nan         nan
          nan         nan         nan         nan]
 [        nan         nan         nan         nan         nan         nan
          nan         nan         nan         nan]
 [-0.01005213  0.49980159  0.65069686  0.13067735  0.42943796  0.06208993
   0.526125    0.62439024  0.2909157   0.46275945]
 [        nan         nan         nan         nan         nan         nan
          nan         nan         nan         nan]
 [ 0.03843844  0.5152381   0.8445993   0.05690426  0.47988516  0.46682553
   0.72301716  0.75603949  0.69918229  0.7281602 ]
 [        nan         nan         nan         nan         nan         nan
          nan         nan         nan         nan]
 [        nan         nan         nan         nan         nan         nan
          nan         nan         nan         nan]
 [ 0.24232762  0.62187229  0.6195122   0.60771109  0.61365492  0.12420728
   0.55136396  0.66759582  0.33557039  0.5032789 ]
 [ 0.03118802  0.51361275  0.58135889  0.25752137  0.43964112 -0.00468085
   0.49833333  0.73199768  0.          0.42260903]
 [        nan         nan         nan         nan         nan         nan
          nan         nan         nan         nan]
 [ 0.25661625  0.60645604  0.73455285  0.46958759  0.59589777  0.46900402
   0.73928571  0.73931475  0.72483241  0.73353522]
 [ 0.02772856  0.51148148  0.64117305  0.15950938  0.43309811  0.29006785
   0.63527828  0.68896632  0.5667688   0.62704869]
 [ 0.1938689   0.58759446  0.67003484  0.42542563  0.54931703  0.02855879
   0.51148148  0.64831591  0.08815462  0.41635647]]
GBM mean:
[0.14957017 0.56715287 0.69380565 0.32417727 0.5265066  0.20771276
 0.59798468 0.69836108 0.38518202 0.55749202]
---------------------------
---------------------------
BDDAE performance:
[[0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]]
BDDAE mean:
[0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
---------------------------
---------------------------
DUMMY performance:
[[0.         0.5        0.6626597  0.         0.3985422  0.
  0.5        0.58850174 0.         0.37045402]
 [0.         0.5        0.68420441 0.         0.40622984 0.
  0.5        0.69384437 0.         0.40961771]
 [0.         0.5        0.50958188 0.         0.3375336  0.
  0.5        0.5358885  0.         0.34887973]
 [0.         0.5        0.59570267 0.         0.37330933 0.
  0.5        0.6029036  0.         0.37610876]
 [0.         0.5        0.66504065 0.         0.39941176 0.
  0.5        0.61718931 0.         0.38163993]
 [0.         0.5        0.58135889 0.         0.36760463 0.
  0.5        0.5981417  0.         0.37426504]
 [0.         0.5        0.84216028 0.         0.45714023 0.
  0.5        0.59570267 0.         0.37330933]
 [0.         0.5        0.65551684 0.         0.3959335  0.
  0.5        0.63159117 0.         0.38707486]
 [0.         0.5        0.77276423 0.         0.43588745 0.
  0.5        0.50720093 0.         0.33649194]
 [0.         0.5        0.51434379 0.         0.33961694 0.
  0.5        0.63873403 0.         0.38976028]
 [0.         0.5        0.58135889 0.         0.36760463 0.
  0.5        0.7344367  0.         0.42343398]
 [0.         0.5        0.54065041 0.         0.35089896 0.
  0.5        0.55981417 0.         0.35886801]
 [0.         0.5        0.67706156 0.         0.40369463 0.
  0.5        0.50243902 0.         0.3344086 ]
 [0.         0.5        0.64355401 0.         0.39155533 0.
  0.5        0.6029036  0.         0.37610876]
 [0.         0.5        0.60766551 0.         0.37795248 0.
  0.5        0.64111498 0.         0.39065542]]
DUMMY mean:
[0.         0.5        0.63557491 0.         0.38686104 0.
 0.5        0.60336043 0.         0.37540509]
---------------------------
Current folder: C:\Users\Javier\Dropbox\c_sldl_3_1_7
-------------------------------------
----- RESULTS ------
-------------------------------------
Window size (sec):  3.008
step (sec):  3.008
overlap:  True
perc. of overlap:  0.0
Number of windows / instances:  418
---------------------------
ALG Means: 
-rows: alg : KNN = 0; DT = 1; RF = 2; SVM = 3; GBM = 4; BDDAE = 5; DUMMY = 5
columns:
'val_cohen','val_uar', 'val_acc', 'val_gm',  'val_f1',  'aro_cohen','aro_uar', 'aro_acc', 'aro_gm',  'aro_f1'
-------------------------------------------------------------
  v_c   v_u   v_a   v_g   v_f1  a_c   a_u   a_a   a_g   a_f1
[[0.197 0.593 0.671 0.523 0.592 0.246 0.621 0.666 0.588 0.619]
 [0.193 0.605 0.648 0.576 0.602 0.232 0.616 0.639 0.595 0.613]
 [0.216 0.599 0.658 0.559 0.597 0.237 0.613 0.646 0.598 0.613]
 [0.082 0.536 0.673 0.178 0.468 0.08  0.54  0.656 0.147 0.455]
 [0.15  0.567 0.694 0.324 0.527 0.208 0.598 0.698 0.385 0.557]
 [0.    0.    0.    0.    0.    0.    0.    0.    0.    0.   ]
 [0.    0.5   0.636 0.    0.387 0.    0.5   0.603 0.    0.375]]
Elapsed time: 4.949141744772593 minutes
Elapsed time: 0.08248569574620988 hours
