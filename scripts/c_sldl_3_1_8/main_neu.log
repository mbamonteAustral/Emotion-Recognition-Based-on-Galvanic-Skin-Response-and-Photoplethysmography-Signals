2024-03-07 18:40:36.828082: I tensorflow/core/util/port.cc:113] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2024-03-07 18:40:37.565694: I tensorflow/core/util/port.cc:113] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2024-03-07 18:40:39.034985: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
    
    
-------------------------------
participant:  1
-------------------------------
    
    
participant:  1
corriendo en PC gamer:
Window size (sec):  3.0
step (sec):  2.25
overlap:  True
perc. of overlap:  25.0
Nearest multiple of 16 to 3000 is: 3008
Nearest multiple of 16 to 2250 is: 2256
['gsr_chunks', 'ppg_chunks', 'val_chunks', 'aro_chunks', 'time_chunks', 'tag_chunks', 'video']
C:\Users\Javier\Dropbox\c_sldl_3_1_8\functions.py:880: FutureWarning: ChainedAssignmentError: behaviour will change in pandas 3.0!

----- Extracting features...
C:\Users\Javier\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\heartpy\analysis.py:522: UserWarning: Short signal.

---------Warning:---------
too few peak-peak intervals for (reliable) frequency domain measure computation, frequency output measures are still computed but treat them with caution!

HF is usually computed over a minimum of 1 minute of good signal. LF is usually computed over a minimum of 2 minutes of good signal.VLF is usually computed over a minimum of 5 minutes of good signal.The LF/HF ratio is usually computed over minimum 24 hours, although an absolute minimum of 5 min has also been suggested.

For more info see: 
Shaffer, F., Ginsberg, J.P. (2017), An Overview of Heart Rate Variability Metrics and Norms.

Task Force of Pacing and Electrophysiology (1996), Heart Rate Variability, in: European Heart Journal, vol.17, issue 3, pp354-381

This warning will not repeat
  warnings.warn(msg, UserWarning)
C:\Users\Javier\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\heartpy\analysis.py:532: UserWarning: 
The maximal number of iterations maxit (set to 20 by the program)
allowed for finding a smoothing spline with fp=s has been reached: s
too small.
There is an approximation returned but the corresponding weighted sum
of squared residuals does not satisfy the condition abs(fp-s)/s < tol.
  interpolation_func = UnivariateSpline(rr_x, rr_list, k=degree_smoothing_spline)
Class Imbalance test (arousal)....
Multiclass distribution
Class=1, n=363 (65.405%)
Class=0, n=192 (34.595%)
Class Imbalance test (valence)....
Multiclass distribution
Class=0, n=217 (39.099%)
Class=1, n=338 (60.901%)
------------- Evaluating model --------------
------------- Evaluating model --------------
------------- Evaluating model --------------
------------- Evaluating model --------------
------------- Evaluating model --------------
arousal and valece = ok
------------- Evaluating model --------------
-------------------------------------
-------------------------------------
participant:  30
-------------------------------------
----- RESULTS ------
-------------------------------------
Window size (sec):  3.008
step (sec):  2.256
overlap:  True
perc. of overlap:  25.0
Number of windows / instances:  555
-rows: alg : KNN = 0; DT = 1; RF = 2; SVM = 3; GBM = 4; BDDAE = 5; DUMMY = 5
columns:
'val_cohen','val_uar', 'val_acc', 'val_gm',  'val_f1',  'aro_cohen','aro_uar', 'aro_acc', 'aro_gm',  'aro_f1'
-------------------------------------------------------------
  v_c   v_u   v_a   v_g   v_f1  a_c   a_u   a_a   a_g   a_f1
[[0.305 0.652 0.67  0.642 0.651 0.205 0.6   0.647 0.577 0.601]
 [0.376 0.686 0.701 0.684 0.685 0.304 0.651 0.687 0.624 0.65 ]
 [0.431 0.67  0.697 0.675 0.671 0.375 0.654 0.703 0.63  0.656]
 [0.    0.5   0.609 0.    0.378 0.    0.5   0.654 0.    0.395]
 [0.286 0.628 0.697 0.539 0.614 0.164 0.571 0.692 0.365 0.532]
 [0.    0.    0.    0.    0.    0.    0.    0.    0.    0.   ]
 [0.    0.5   0.609 0.    0.378 0.    0.5   0.654 0.    0.395]]
participant performance loaded
    
    
-------------------------------
LAST participant's saved data: 
30
-------------------------------
    
    
---------------------------
KNN performance:
[[0.46193408 0.71685238 0.77512987 0.69304635 0.72845292 0.25638504
  0.62678834 0.64191558 0.61761533 0.6256408 ]
 [0.2264733  0.60374957 0.69366883 0.54922772 0.60758809 0.19579803
  0.59181154 0.68649351 0.52424656 0.59141981]
 [       nan        nan        nan        nan        nan        nan
         nan        nan        nan        nan]
 [       nan        nan        nan        nan        nan        nan
         nan        nan        nan        nan]
 [       nan        nan        nan        nan        nan        nan
         nan        nan        nan        nan]
 [0.10798511 0.53953066 0.8325     0.29186633 0.5386153  0.27085603
  0.63443773 0.64883117 0.62775446 0.63402922]
 [       nan        nan        nan        nan        nan        nan
         nan        nan        nan        nan]
 [0.01380338 0.50687024 0.50649351 0.50461551 0.50542955 0.15316095
  0.57383041 0.63061688 0.52852949 0.57100511]
 [0.11568696 0.55815629 0.57116883 0.54728477 0.55603571 0.10117369
  0.54366289 0.69704545 0.42278125 0.53977426]
 [       nan        nan        nan        nan        nan        nan
         nan        nan        nan        nan]
 [0.18314941 0.58710317 0.6325     0.55879376 0.58791126 0.29618571
  0.6433252  0.67366883 0.62151252 0.64411907]
 [0.30486285 0.65192895 0.67006494 0.64236238 0.65066132 0.20455057
  0.59960329 0.64714286 0.57672267 0.60077597]]
KNN mean:
[0.20198501 0.59488447 0.66878942 0.54102812 0.59638488 0.21115857
 0.60192277 0.66081633 0.55988033 0.60096632]
---------------------------
---------------------------
DT performance:
[[0.39227979 0.72493283 0.74402597 0.70850282 0.7180261  0.35391479
  0.66289623 0.67246753 0.66849469 0.66136231]
 [0.24279312 0.62338321 0.67214286 0.60646126 0.62147474 0.16275457
  0.57376955 0.63944805 0.5663765  0.57424991]
 [0.0209246  0.54083546 0.55487013 0.50657399 0.53778804 0.24841209
  0.6193579  0.64146104 0.60262844 0.61801191]
 [0.20208473 0.59056227 0.62545455 0.57618134 0.58299418 0.25275455
  0.63446015 0.64863636 0.61339959 0.63277866]
 [0.61354873 0.79827693 0.80535714 0.80923016 0.79784448 0.35033661
  0.67905138 0.68659091 0.68179958 0.67670384]
 [0.203022   0.63276159 0.80730519 0.58140639 0.63190794 0.32586468
  0.68139774 0.69568182 0.68466974 0.68032327]
 [0.17398996 0.60891181 0.64311688 0.5638467  0.60383853 0.13054198
  0.57126984 0.59470779 0.5735119  0.56696731]
 [0.03249965 0.52269711 0.52418831 0.51237224 0.52107669 0.10342809
  0.551132   0.58743506 0.52933215 0.55052829]
 [0.05772507 0.52333663 0.53886364 0.52022293 0.52079671 0.15774138
  0.57561992 0.6737013  0.53981336 0.5741829 ]
 [0.33861962 0.66370573 0.70444805 0.64367496 0.66077102 0.4051452
  0.69365079 0.69357143 0.71075584 0.69247802]
 [0.22242914 0.59876984 0.62873377 0.60314859 0.59779609 0.30210734
  0.65223398 0.66464286 0.6297241  0.65124642]
 [0.37608289 0.68562516 0.70084416 0.68356414 0.68536714 0.30424148
  0.65100284 0.68652597 0.62422722 0.64979182]]
DT mean:
[0.23966661 0.62614988 0.66244589 0.60959879 0.62330681 0.25810356
 0.62882019 0.65707251 0.61872776 0.62738539]
---------------------------
---------------------------
RF performance:
[[0.49143589 0.71624388 0.76233766 0.70971463 0.72003823 0.4250552
  0.69511935 0.70847403 0.67205194 0.69473716]
 [0.30173176 0.62426901 0.69915584 0.6052107  0.62666867 0.21445152
  0.62855045 0.70613636 0.6034244  0.63336317]
 [0.07854846 0.53214369 0.56204545 0.49823565 0.5297713  0.38699959
  0.69666163 0.71892857 0.64779764 0.698923  ]
 [0.16242938 0.54332622 0.60720779 0.56366253 0.53934092 0.07292188
  0.62573848 0.65237013 0.53809114 0.62721799]
 [0.67627523 0.83147439 0.83603896 0.81149026 0.83001866 0.43214449
  0.69252306 0.70636364 0.70976361 0.69205945]
 [0.19554335 0.60560438 0.83970779 0.4839443  0.62770913 0.30778663
  0.69024645 0.7012987  0.65122438 0.6891162 ]
 [0.15175143 0.55125573 0.62181818 0.54098485 0.54946961 0.21324157
  0.60710317 0.64324675 0.53935555 0.60560097]
 [0.08157249 0.53909362 0.54016234 0.54980251 0.5380152  0.25458495
  0.60242899 0.65779221 0.54554838 0.60346265]
 [0.04101631 0.56188653 0.58198052 0.52643794 0.56093188 0.08530163
  0.5549158  0.68821429 0.42014887 0.55124311]
 [0.41377589 0.71836294 0.76918831 0.66673622 0.72426429 0.4592169
  0.71878307 0.71883117 0.70996858 0.71834322]
 [0.16836907 0.58055556 0.63055195 0.579046   0.57950898 0.34036883
  0.65121483 0.66477273 0.64049872 0.64946847]
 [0.43095704 0.67002165 0.69711039 0.67463749 0.67107678 0.37494155
  0.65416548 0.70262987 0.63010623 0.65550391]]
RF mean:
[0.26611719 0.62285313 0.6789421  0.60082525 0.62473447 0.29725123
 0.65145423 0.6890882  0.60899829 0.65158661]
---------------------------
---------------------------
SVM performance:
[[0.48680054 0.71305516 0.80207792 0.65651099 0.73172932 0.29119342
  0.63864024 0.67415584 0.608368   0.63916613]
 [0.         0.5        0.68474026 0.         0.40642873 0.
  0.5        0.6900974  0.         0.40831003]
 [       nan        nan        nan        nan        nan        nan
         nan        nan        nan        nan]
 [       nan        nan        nan        nan        nan        nan
         nan        nan        nan        nan]
 [       nan        nan        nan        nan        nan        nan
         nan        nan        nan        nan]
 [0.         0.5        0.8450974  0.         0.45801362 0.00149665
  0.50067426 0.58217532 0.13005917 0.40805133]
 [       nan        nan        nan        nan        nan        nan
         nan        nan        nan        nan]
 [0.12382616 0.56228422 0.55681818 0.52817294 0.54274327 0.
  0.5        0.64142857 0.         0.39076817]
 [0.         0.5        0.58198052 0.         0.36787127 0.
  0.5        0.73516234 0.         0.42367573]
 [       nan        nan        nan        nan        nan        nan
         nan        nan        nan        nan]
 [0.         0.5        0.63425325 0.         0.38808993 0.02689914
  0.51136364 0.60899351 0.07956759 0.39785104]
 [0.         0.5        0.60902597 0.         0.37849563 0.
  0.5        0.65405844 0.         0.39541791]]
SVM mean:
[0.08723239 0.5393342  0.67342764 0.16924056 0.46762454 0.0456556
 0.52152545 0.65515306 0.11685639 0.43760576]
---------------------------
---------------------------
GBM performance:
[[0.48010969 0.70914731 0.79665584 0.65253124 0.72560844 0.34496554
  0.65697318 0.71357143 0.58323118 0.64973653]
 [0.14315435 0.55861713 0.71704545 0.34107034 0.52347954 0.0134401
  0.50507264 0.6863961  0.10509772 0.43207305]
 [       nan        nan        nan        nan        nan        nan
         nan        nan        nan        nan]
 [       nan        nan        nan        nan        nan        nan
         nan        nan        nan        nan]
 [       nan        nan        nan        nan        nan        nan
         nan        nan        nan        nan]
 [0.01734317 0.50555556 0.84688312 0.03333333 0.46846098 0.3919813
  0.68353484 0.72824675 0.63453352 0.68233167]
 [       nan        nan        nan        nan        nan        nan
         nan        nan        nan        nan]
 [0.18758552 0.59217226 0.59087662 0.58913104 0.58996553 0.10428338
  0.5399457  0.66126623 0.29990208 0.48393296]
 [0.00540316 0.50261446 0.57655844 0.16586971 0.40532001 0.
  0.5        0.73516234 0.         0.42367573]
 [       nan        nan        nan        nan        nan        nan
         nan        nan        nan        nan]
 [0.0383129  0.5159127  0.6413961  0.14894209 0.43009605 0.29199384
  0.63318221 0.6937013  0.5445759  0.61805687]
 [0.28580334 0.62837408 0.69724026 0.53866454 0.61415002 0.16431682
  0.57089379 0.69181818 0.36512804 0.531544  ]]
GBM mean:
[0.16538745 0.57319907 0.69523655 0.35279175 0.5367258  0.187283
 0.58422891 0.70145176 0.36178121 0.54590726]
---------------------------
---------------------------
BDDAE performance:
[[0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]]
BDDAE mean:
[0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
---------------------------
---------------------------
DUMMY performance:
[[0.         0.5        0.66672078 0.         0.40001169 0.
  0.5        0.59642857 0.         0.37359238]
 [0.         0.5        0.68474026 0.         0.40642873 0.
  0.5        0.6900974  0.         0.40831003]
 [0.         0.5        0.6        0.         0.37499064 0.
  0.5        0.59821429 0.         0.37429151]
 [0.         0.5        0.6649026  0.         0.39935474 0.
  0.5        0.61266234 0.         0.37990012]
 [0.         0.5        0.58737013 0.         0.3700197  0.
  0.5        0.59464286 0.         0.37289326]
 [0.         0.5        0.8450974  0.         0.45801362 0.
  0.5        0.59642857 0.         0.37359238]
 [0.         0.5        0.65405844 0.         0.39541791 0.
  0.5        0.63425325 0.         0.38808993]
 [0.         0.5        0.51529221 0.         0.3400518  0.
  0.5        0.64142857 0.         0.39076817]
 [0.         0.5        0.58198052 0.         0.36787127 0.
  0.5        0.73516234 0.         0.42367573]
 [0.         0.5        0.6811039  0.         0.40514309 0.
  0.5        0.50272727 0.         0.33453325]
 [0.         0.5        0.63425325 0.         0.38808993 0.
  0.5        0.6        0.         0.37499064]
 [0.         0.5        0.60902597 0.         0.37849563 0.
  0.5        0.65405844 0.         0.39541791]]
DUMMY mean:
[0.         0.5        0.64371212 0.         0.39032406 0.
 0.5        0.62134199 0.         0.38250461]
---------------------------
Current folder: C:\Users\Javier\Dropbox\c_sldl_3_1_8
-------------------------------------
----- RESULTS ------
-------------------------------------
Window size (sec):  3.008
step (sec):  2.256
overlap:  True
perc. of overlap:  25.0
Number of windows / instances:  555
---------------------------
ALG Means: 
-rows: alg : KNN = 0; DT = 1; RF = 2; SVM = 3; GBM = 4; BDDAE = 5; DUMMY = 5
columns:
'val_cohen','val_uar', 'val_acc', 'val_gm',  'val_f1',  'aro_cohen','aro_uar', 'aro_acc', 'aro_gm',  'aro_f1'
-------------------------------------------------------------
  v_c   v_u   v_a   v_g   v_f1  a_c   a_u   a_a   a_g   a_f1
[[0.202 0.595 0.669 0.541 0.596 0.211 0.602 0.661 0.56  0.601]
 [0.24  0.626 0.662 0.61  0.623 0.258 0.629 0.657 0.619 0.627]
 [0.266 0.623 0.679 0.601 0.625 0.297 0.651 0.689 0.609 0.652]
 [0.087 0.539 0.673 0.169 0.468 0.046 0.522 0.655 0.117 0.438]
 [0.165 0.573 0.695 0.353 0.537 0.187 0.584 0.701 0.362 0.546]
 [0.    0.    0.    0.    0.    0.    0.    0.    0.    0.   ]
 [0.    0.5   0.644 0.    0.39  0.    0.5   0.621 0.    0.383]]
Elapsed time: 5.69365820089976 minutes
Elapsed time: 0.09489430334832934 hours
