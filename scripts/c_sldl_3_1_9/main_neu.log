2024-03-07 18:46:23.755372: I tensorflow/core/util/port.cc:113] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2024-03-07 18:46:24.484993: I tensorflow/core/util/port.cc:113] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2024-03-07 18:46:25.942743: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
    
    
-------------------------------
participant:  1
-------------------------------
    
    
participant:  1
corriendo en PC gamer:
Window size (sec):  3.0
step (sec):  1.5
overlap:  True
perc. of overlap:  50.0
Nearest multiple of 16 to 3000 is: 3008
Nearest multiple of 16 to 1500 is: 1504
['gsr_chunks', 'ppg_chunks', 'val_chunks', 'aro_chunks', 'time_chunks', 'tag_chunks', 'video']
C:\Users\Javier\Dropbox\c_sldl_3_1_9\functions.py:880: FutureWarning: ChainedAssignmentError: behaviour will change in pandas 3.0!

----- Extracting features...
C:\Users\Javier\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\heartpy\analysis.py:522: UserWarning: Short signal.

---------Warning:---------
too few peak-peak intervals for (reliable) frequency domain measure computation, frequency output measures are still computed but treat them with caution!

HF is usually computed over a minimum of 1 minute of good signal. LF is usually computed over a minimum of 2 minutes of good signal.VLF is usually computed over a minimum of 5 minutes of good signal.The LF/HF ratio is usually computed over minimum 24 hours, although an absolute minimum of 5 min has also been suggested.

For more info see: 
Shaffer, F., Ginsberg, J.P. (2017), An Overview of Heart Rate Variability Metrics and Norms.

Task Force of Pacing and Electrophysiology (1996), Heart Rate Variability, in: European Heart Journal, vol.17, issue 3, pp354-381

This warning will not repeat
  warnings.warn(msg, UserWarning)
C:\Users\Javier\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\heartpy\analysis.py:677: UserWarning: 
The maximal number of iterations maxit (set to 20 by the program)
allowed for finding a smoothing spline with fp=s has been reached: s
too small.
There is an approximation returned but the corresponding weighted sum
of squared residuals does not satisfy the condition abs(fp-s)/s < tol.
  interp = UnivariateSpline(x, rrlist, k=3)
C:\Users\Javier\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.12_qbz5n2kfra8p0\LocalCache\local-packages\Python312\site-packages\heartpy\analysis.py:532: UserWarning: 
The maximal number of iterations maxit (set to 20 by the program)
allowed for finding a smoothing spline with fp=s has been reached: s
too small.
There is an approximation returned but the corresponding weighted sum
of squared residuals does not satisfy the condition abs(fp-s)/s < tol.
  interpolation_func = UnivariateSpline(rr_x, rr_list, k=degree_smoothing_spline)
Class Imbalance test (arousal)....
Multiclass distribution
Class=1, n=541 (65.024%)
Class=0, n=291 (34.976%)
Class Imbalance test (valence)....
Multiclass distribution
Class=0, n=324 (38.942%)
Class=1, n=508 (61.058%)
------------- Evaluating model --------------
------------- Evaluating model --------------
------------- Evaluating model --------------
------------- Evaluating model --------------
------------- Evaluating model --------------
arousal and valece = ok
------------- Evaluating model --------------
-------------------------------------
-------------------------------------
participant:  30
-------------------------------------
----- RESULTS ------
-------------------------------------
Window size (sec):  3.008
step (sec):  1.504
overlap:  True
perc. of overlap:  50.0
Number of windows / instances:  832
-rows: alg : KNN = 0; DT = 1; RF = 2; SVM = 3; GBM = 4; BDDAE = 5; DUMMY = 5
columns:
'val_cohen','val_uar', 'val_acc', 'val_gm',  'val_f1',  'aro_cohen','aro_uar', 'aro_acc', 'aro_gm',  'aro_f1'
-------------------------------------------------------------
  v_c   v_u   v_a   v_g   v_f1  a_c   a_u   a_a   a_g   a_f1
[[0.33  0.664 0.684 0.656 0.664 0.355 0.678 0.709 0.665 0.677]
 [0.35  0.681 0.693 0.661 0.677 0.333 0.679 0.706 0.659 0.677]
 [0.372 0.702 0.726 0.673 0.704 0.367 0.683 0.721 0.66  0.685]
 [0.004 0.502 0.612 0.018 0.382 0.    0.5   0.65  0.    0.394]
 [0.227 0.598 0.681 0.455 0.565 0.008 0.503 0.65  0.063 0.406]
 [0.    0.    0.    0.    0.    0.    0.    0.    0.    0.   ]
 [0.    0.5   0.611 0.    0.379 0.    0.5   0.65  0.    0.394]]
participant performance loaded
    
    
-------------------------------
LAST participant's saved data: 
30
-------------------------------
    
    
---------------------------
KNN performance:
[[0.54021416 0.75063071 0.81246414 0.72519384 0.76647422 0.38769176
  0.69128189 0.70806081 0.68371791 0.69271809]
 [0.25621872 0.61814184 0.70427424 0.57130609 0.62353506 0.31510773
  0.64703029 0.72715146 0.60729161 0.65349168]
 [0.08049541 0.53038255 0.82332186 0.28287852 0.52836811 0.30776005
  0.65321227 0.6670109  0.64566126 0.65184943]
 [       nan        nan        nan        nan        nan        nan
         nan        nan        nan        nan]
 [0.08721593 0.54366634 0.54338784 0.54076307 0.54198649 0.17788034
  0.58583038 0.63819564 0.55531945 0.58661812]
 [0.12385265 0.56168993 0.57802639 0.54763524 0.55965737 0.20249237
  0.59256155 0.72368044 0.50940085 0.59353282]
 [0.12421845 0.55951557 0.61409925 0.52003676 0.55807825 0.33611133
  0.66165983 0.69472174 0.63657336 0.66306203]
 [0.33003233 0.66362478 0.6837206  0.65618895 0.66444677 0.3554329
  0.67768083 0.70900746 0.66534971 0.67702525]]
KNN mean:
[0.22032109 0.60395024 0.67989919 0.54914321 0.60607804 0.29749664
 0.64417958 0.69540407 0.61475917 0.64547106]
---------------------------
---------------------------
DT performance:
[[0.49098836 0.7548545  0.77392427 0.74784713 0.74942216 0.40572519
  0.70274302 0.71757028 0.68781961 0.70309956]
 [0.24334124 0.61983108 0.67195927 0.60872687 0.61875635 0.16735894
  0.59700168 0.64413368 0.56031137 0.59311009]
 [0.2860623  0.6501598  0.81724039 0.55453522 0.64915721 0.35604557
  0.67048685 0.68387837 0.67098575 0.66953215]
 [0.2090538  0.59047544 0.63093804 0.57396884 0.58683775 0.27149547
  0.62859809 0.65263913 0.61186343 0.62586991]
 [0.11620614 0.56177258 0.56128801 0.54967994 0.55917441 0.26771416
  0.6462663  0.67553069 0.62424932 0.64523838]
 [0.00912295 0.52583383 0.53737808 0.50336591 0.52364009 0.21632391
  0.59446332 0.68638841 0.57452537 0.59487991]
 [0.13381251 0.56965826 0.60694205 0.5488648  0.56902243 0.33502488
  0.66891287 0.68151176 0.65638137 0.66782425]
 [0.35005316 0.68067881 0.69348824 0.66086571 0.67708605 0.33255719
  0.67925578 0.70552209 0.65851046 0.67707169]]
DT mean:
[0.22983006 0.61915804 0.66164479 0.5934818  0.61663706 0.29403066
 0.64846599 0.6808968  0.63058084 0.64707824]
---------------------------
---------------------------
RF performance:
[[0.51936948 0.76622475 0.81609294 0.74858994 0.77716925 0.4002525
  0.71297093 0.72122777 0.70893287 0.71101049]
 [0.23865768 0.63024338 0.70068847 0.59857815 0.63307845 0.2669679
  0.64345623 0.71517499 0.57898144 0.64683353]
 [0.15325055 0.57179087 0.82690763 0.48533825 0.57534499 0.4184317
  0.68421947 0.70065978 0.70042887 0.6849663 ]
 [0.21388311 0.62931117 0.67435456 0.58216126 0.63004382 0.20518618
  0.6098377  0.65631096 0.59769818 0.60988377]
 [0.09608817 0.57527476 0.5756311  0.5569916  0.57233247 0.2816041
  0.62965264 0.67657774 0.58132874 0.6323694 ]
 [0.07350998 0.52250625 0.54442054 0.52472315 0.52017552 0.14909188
  0.55934654 0.70078887 0.47943239 0.55783043]
 [0.1437647  0.579476   0.62611876 0.5782358  0.5789409  0.35863351
  0.6581135  0.67188755 0.68342734 0.65669876]
 [0.37221348 0.70200936 0.7259323  0.67304631 0.70364933 0.36743035
  0.68341867 0.72109868 0.65998037 0.68479834]]
RF mean:
[0.22634214 0.62210457 0.68626829 0.59345806 0.62384184 0.30594976
 0.64762696 0.69546579 0.62377627 0.64804888]
---------------------------
---------------------------
SVM performance:
[[0.52094561 0.73318603 0.81252151 0.69029591 0.75247745 0.32901684
  0.65692288 0.69113597 0.63110638 0.65949283]
 [0.02875299 0.51066127 0.69350258 0.10618146 0.43069405 0.06404545
  0.52461138 0.69832186 0.23024137 0.46629518]
 [0.         0.5        0.84736087 0.         0.45868276 0.28419256
  0.64241467 0.65385829 0.63787375 0.64098432]
 [       nan        nan        nan        nan        nan        nan
         nan        nan        nan        nan]
 [0.11984007 0.56048355 0.5551922  0.51160865 0.53352617 0.
  0.5        0.6454389  0.         0.39225293]
 [0.         0.5        0.58052209 0.         0.36729397 0.
  0.5        0.73438038 0.         0.42342361]
 [0.         0.5        0.63822433 0.         0.38958127 0.10594153
  0.54605268 0.62620482 0.35669979 0.48904245]
 [0.00381308 0.5015625  0.61179002 0.01767767 0.3824182  0.
  0.5        0.65024383 0.         0.39402725]]
SVM mean:
[0.09619311 0.54369905 0.67701623 0.18939481 0.47352484 0.1118852
 0.55285737 0.67136915 0.26513161 0.49507408]
---------------------------
---------------------------
GBM performance:
[[ 0.54543117  0.73879028  0.82335055  0.69042624  0.76113181  0.40148478
   0.68481891  0.73559954  0.62833003  0.68456477]
 [ 0.1849799   0.57308856  0.72596099  0.38466169  0.54674625  0.03197599
   0.51198301  0.69473609  0.12257228  0.43763944]
 [ 0.02464789  0.50769231  0.84977051  0.05547002  0.47357047  0.44889493
   0.71288246  0.74883821  0.68698255  0.71872594]
 [        nan         nan         nan         nan         nan         nan
          nan         nan         nan         nan]
 [ 0.21725193  0.6091926   0.60697074  0.59659237  0.60187065  0.08258416
   0.53331755  0.66583477  0.26128418  0.46480206]
 [ 0.01432817  0.50636004  0.58053643  0.1799216   0.40468458 -0.00235925
   0.49918033  0.73317556  0.          0.42302054]
 [ 0.0345227   0.51424123  0.64182444  0.15757235  0.43245757  0.25784237
   0.61806079  0.67547332  0.5373959   0.60475278]
 [ 0.22660178  0.59767391  0.68144005  0.45533326  0.5651101   0.00793141
   0.50315221  0.65022949  0.06267435  0.40610744]]
GBM mean:
[0.17825193 0.57814842 0.70140767 0.35999679 0.54079592 0.1754792
 0.58048504 0.70055528 0.32846276 0.53423042]
---------------------------
---------------------------
BDDAE performance:
[[0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]]
BDDAE mean:
[0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
---------------------------
---------------------------
DUMMY performance:
[[0.         0.5        0.66947791 0.         0.40100407 0.
  0.5        0.59615605 0.         0.37348765]
 [0.         0.5        0.68749283 0.         0.40740443 0.
  0.5        0.68990247 0.         0.40824536]
 [0.         0.5        0.84736087 0.         0.45868276 0.
  0.5        0.59856569 0.         0.3744332 ]
 [0.         0.5        0.65745841 0.         0.39666023 0.
  0.5        0.63703385 0.         0.38913697]
 [0.         0.5        0.51201951 0.         0.33862447 0.
  0.5        0.6454389  0.         0.39225293]
 [0.         0.5        0.58052209 0.         0.36729397 0.
  0.5        0.73438038 0.         0.42342361]
 [0.         0.5        0.63822433 0.         0.38958127 0.
  0.5        0.59856569 0.         0.3744332 ]
 [0.         0.5        0.6105852  0.         0.37910173 0.
  0.5        0.65024383 0.         0.39402725]]
DUMMY mean:
[0.         0.5        0.65039264 0.         0.39229412 0.
 0.5        0.64378586 0.         0.39118002]
---------------------------
Current folder: C:\Users\Javier\Dropbox\c_sldl_3_1_9
-------------------------------------
----- RESULTS ------
-------------------------------------
Window size (sec):  3.008
step (sec):  1.504
overlap:  True
perc. of overlap:  50.0
Number of windows / instances:  832
---------------------------
ALG Means: 
-rows: alg : KNN = 0; DT = 1; RF = 2; SVM = 3; GBM = 4; BDDAE = 5; DUMMY = 5
columns:
'val_cohen','val_uar', 'val_acc', 'val_gm',  'val_f1',  'aro_cohen','aro_uar', 'aro_acc', 'aro_gm',  'aro_f1'
-------------------------------------------------------------
  v_c   v_u   v_a   v_g   v_f1  a_c   a_u   a_a   a_g   a_f1
[[0.22  0.604 0.68  0.549 0.606 0.297 0.644 0.695 0.615 0.645]
 [0.23  0.619 0.662 0.593 0.617 0.294 0.648 0.681 0.631 0.647]
 [0.226 0.622 0.686 0.593 0.624 0.306 0.648 0.695 0.624 0.648]
 [0.096 0.544 0.677 0.189 0.474 0.112 0.553 0.671 0.265 0.495]
 [0.178 0.578 0.701 0.36  0.541 0.175 0.58  0.701 0.328 0.534]
 [0.    0.    0.    0.    0.    0.    0.    0.    0.    0.   ]
 [0.    0.5   0.65  0.    0.392 0.    0.5   0.644 0.    0.391]]
Elapsed time: 7.266212006409963 minutes
Elapsed time: 0.12110353344016606 hours
